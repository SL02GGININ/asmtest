<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>零食天堂 - 優質零食網購平台</title>
    
    <!-- React & React DOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Animation classes */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        /* Loading spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #5D5CDE;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Product card hover effect */
        .product-card {
            transition: all 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        /* Button animations */
        .btn-primary {
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: scale(1.05);
        }
        
        .btn-primary:active {
            transform: scale(0.95);
        }
        
        /* Badge pulse animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .badge-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            ::-webkit-scrollbar-track {
                background: #1a1a1a;
            }
        }
        
        /* Responsive image */
        img {
            max-width: 100%;
            height: auto;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            animation: slideIn 0.3s ease-out;
        }
        
        /* Modal overlay */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        /* Chatbot styles */
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chatbot-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5D5CDE, #8A88FF);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(93, 92, 222, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .chatbot-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(93, 92, 222, 0.6);
        }
        
        .chatbot-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .chatbot-header {
            background: linear-gradient(135deg, #5D5CDE, #8A88FF);
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
        }
        
        .bot-message {
            background: #f1f3f5;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        
        .user-message {
            background: #5D5CDE;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        
        .chatbot-input {
            display: flex;
            padding: 16px;
            border-top: 1px solid #e9ecef;
            gap: 8px;
        }
        
        .chatbot-input input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e9ecef;
            border-radius: 24px;
            outline: none;
        }
        
        .chatbot-input input:focus {
            border-color: #5D5CDE;
        }
        
        .chatbot-input button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #5D5CDE;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .chatbot-typing {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            background: #f1f3f5;
            border-radius: 18px;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #868e96;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        
        .quick-reply {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        
        .quick-reply-button {
            background: white;
            border: 1px solid #5D5CDE;
            color: #5D5CDE;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .quick-reply-button:hover {
            background: #5D5CDE;
            color: white;
        }
        
        @media (max-width: 768px) {
            .chatbot-window {
                width: 300px;
                height: 450px;
            }
            
            .chatbot-container {
                bottom: 10px;
                right: 10px;
            }
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#FF6B6B',
                        accent: '#4ECDC4',
                        warning: '#FFE66D',
                        dark: '#2C3E50'
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif']
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, createContext, useContext, useMemo } = React;
        
        // ==================== Data Service (模擬資料庫) ====================
        const DataService = {
            // 模擬 API 延遲
            delay: (ms = 500) => new Promise(resolve => setTimeout(resolve, ms)),
            
            // 產品數據
            products: [
                // 餅乾類
                { id: 1, name: '經典奶油餅乾', category: 'cookies', price: 89, image: 'https://via.placeholder.com/300x300?text=經典奶油餅乾', description: '香濃奶油，口感酥脆', stock: 50, rating: 4.5, sales: 1200 },
                { id: 2, name: '巧克力夾心餅', category: 'cookies', price: 99, image: 'https://via.placeholder.com/300x300?text=巧克力夾心餅', description: '濃郁巧克力夾心', stock: 35, rating: 4.8, sales: 980 },
                { id: 3, name: '蔓越莓燕麥餅', category: 'cookies', price: 109, image: 'https://via.placeholder.com/300x300?text=蔓越莓燕麥餅', description: '健康養生首選', stock: 42, rating: 4.6, sales: 756 },
                { id: 4, name: '抹茶曲奇', category: 'cookies', price: 119, image: 'https://via.placeholder.com/300x300?text=抹茶曲奇', description: '日式抹茶風味', stock: 28, rating: 4.7, sales: 634 },
                
                // 洋芋片類
                { id: 5, name: '原味薯片', category: 'chips', price: 45, image: 'https://via.placeholder.com/300x300?text=原味薯片', description: '經典原味，酥脆可口', stock: 100, rating: 4.4, sales: 2100 },
                { id: 6, name: '海苔薯片', category: 'chips', price: 50, image: 'https://via.placeholder.com/300x300?text=海苔薯片', description: '海苔香氣撲鼻', stock: 85, rating: 4.6, sales: 1890 },
                { id: 7, name: '烤肉薯片', category: 'chips', price: 50, image: 'https://via.placeholder.com/300x300?text=烤肉薯片', description: '炭烤風味十足', stock: 92, rating: 4.5, sales: 1650 },
                { id: 8, name: '芝士薯片', category: 'chips', price: 55, image: 'https://via.placeholder.com/300x300?text=芝士薯片', description: '濃郁起司味', stock: 78, rating: 4.7, sales: 1420 },
                
                // 糖果類
                { id: 9, name: '水果軟糖', category: 'candy', price: 35, image: 'https://via.placeholder.com/300x300?text=水果軟糖', description: '多種水果口味', stock: 120, rating: 4.3, sales: 2500 },
                { id: 10, name: '北海特濃牛奶糖', category: 'candy', price: 28, image: 'https://via.placeholder.com/300x300?text=北海道特濃牛奶糖', description: '香濃牛奶風味', stock: 95, rating: 4.4, sales: 1980 },
                { id: 11, name: '棉花糖', category: 'candy', price: 45, image: 'https://via.placeholder.com/300x300?text=棉花糖', description: '綿密鬆軟', stock: 68, rating: 4.2, sales: 1230 },
                { id: 12, name: 'QQ軟糖', category: 'candy', price: 38, image: 'https://via.placeholder.com/300x300?text=QQ軟糖', description: 'Q彈有嚼勁', stock: 110, rating: 4.5, sales: 1850 },
                
                // 朱克力類
                { id: 13, name: '金莎朱古力禮盒', category: 'chocolate', price: 129, image:'./Image/金莎朱古力禮盒.avif' , description: '金色包裝閃耀奢華，圓潤造型，象徵圓滿與祝福，送禮自用皆體面。', stock: 45, rating: 4.8, sales: 890 },
                { id: 14, name: '明治牛奶朱古力', category: 'chocolate', price: 99, image: './Image/明治牛奶朱古力.jpg', description: '嚴選北歐牛奶與可可豆，經典板狀設計，簡單卻耐人回味。', stock: 62, rating: 4.7, sales: 1340 },
                { id: 15, name: 'M&M\'s 牛奶朱古力', category: 'chocolate', price: 139, image: './Image/M&M_牛奶朱古力.jpg', description: '紅、黃、藍、綠、橙、啡六色糖衣，帶來視覺與味覺的雙重享受。', stock: 38, rating: 4.9, sales: 720 },
                { id: 16, name: 'KitKat 朱古力威化', category: 'chocolate', price: 109, image: './Image/KitKat 朱古力威化.avif', description: '「Have a break, have a KitKat」——享受片刻輕鬆的最佳選擇。', stock: 52, rating: 4.6, sales: 980 },
                { id: 25, name: 'Cadbury 吉百利牛奶朱古力', category: 'chocolate', price: 89, image: './Image/Cadbury 吉百利牛奶朱古力.jpg', description: '入口即化的絲滑口感，帶來滿滿幸福感。', stock: 75, rating: 4.5, sales: 1100 },
                { id: 26, name: 'Ritter Sport 朱古力', category: 'chocolate', price: 79, image: './Image/Ritter Sport 朱古力.webp', description: '德國工藝製作，口感細膩又紮實。', stock: 68, rating: 4.4, sales: 950 },
                { id: 27, name: 'Lindt 瑞士蓮軟心朱古力', category: 'chocolate', price: 159, image: './Image/Lindt 瑞士蓮軟心朱古力.jpg', description: '每一顆都是「融情時刻」，讓幸福在舌尖綻放。', stock: 42, rating: 4.9, sales: 680 },
                { id: 28, name: 'Toblerone 三角朱古力', category: 'chocolate', price: 149, image: './Image/Toblerone 三角朱古力.jpeg', description: '獨特三角造型，象徵瑞士阿爾卑斯山的壯麗。', stock: 55, rating: 4.7, sales: 820 },
                { id: 29, name: 'Hershey\'s Kisses 朱古力', category: 'chocolate', price: 289, image: './Image/Hershey’s Kisses 朱古力.jpg', description: '經典水滴造型，小巧可愛，一口剛剛好。', stock: 28, rating: 4.9, sales: 350 },
                { id: 30, name: 'Snickers 士力架朱古力', category: 'chocolate', price: 69, image: './Image/Snickers 士力架朱古力.jpg', description: '「餓了就吃士力架」，簡單直接的能量宣言。', stock: 88, rating: 4.6, sales: 1250 },
                { id: 31, name: 'Twix 特趣朱古力', category: 'chocolate', price: 65, image: './Image/Twix 特趣朱古力.avif', description: '外層濃郁巧克力，內裡甜蜜焦糖，咬下瞬間層次分明。', stock: 72, rating: 4.5, sales: 980 },
                { id: 32, name: 'Maltesers 麥提莎朱古力', category: 'chocolate', price: 89, image: './Image/Maltesers 麥提莎朱古力.jpg', description: '「Look on the light side」——帶來輕鬆愉快的心情。', stock: 60, rating: 4.7, sales: 780 },
                { id: 33, name: '白之戀人白朱古力', category: 'chocolate', price: 199, image: './Image/白之戀人白朱古力.jpg', description: '純白甜美，簡約典雅的包裝，傳遞高雅與溫暖心意。', stock: 35, rating: 4.8, sales: 450 },
                { id: 34, name: 'Meiji Almond 朱古力', category: 'chocolate', price: 219, image: './Image/Meiji Almond 朱古力.webp', description: '精選加州杏仁，閃亮如寶石的外觀，既美味又適合分享。', stock: 40, rating: 4.9, sales: 520 },
                
                // 堅果類
                { id: 35, name: '綜合堅果', category: 'nuts', price: 159, image: 'https://via.placeholder.com/300x300?text=綜合堅果', description: '營養豐富健康零食', stock: 55, rating: 4.7, sales: 1120 },
                { id: 36, name: '夏威夷豆', category: 'nuts', price: 189, image: 'https://via.placeholder.com/300x300?text=夏威夷豆', description: '香脆可口', stock: 32, rating: 4.8, sales: 670 },
                { id: 37, name: '腰果', category: 'nuts', price: 149, image: 'https://via.placeholder.com/300x300?text=腰果', description: '原味烘焙', stock: 48, rating: 4.6, sales: 890 },
                { id: 38, name: '開心果', category: 'nuts', price: 169, image: 'https://via.placeholder.com/300x300?text=開心果', description: '美國進口', stock: 40, rating: 4.7, sales: 760 },
                
                // 果乾類
                { id: 39, name: '蔓越莓乾', category: 'dried-fruit', price: 119, image: 'https://via.placeholder.com/300x300?text=蔓越莓乾', description: '天然無添加', stock: 65, rating: 4.5, sales: 1050 },
                { id: 40, name: '芒果乾', category: 'dried-fruit', price: 129, image: 'https://via.placeholder.com/300x300?text=芒果乾', description: '香甜多汁', stock: 58, rating: 4.6, sales: 920 },
                { id: 41, name: '葡萄乾', category: 'dried-fruit', price: 89, image: 'https://via.placeholder.com/300x300?text=葡萄乾', description: '新疆特產', stock: 72, rating: 4.4, sales: 1180 },
                { id: 42, name: '無花果乾', category: 'dried-fruit', price: 139, image: 'https://via.placeholder.com/300x300?text=無花果乾', description: '土耳其進口', stock: 44, rating: 4.7, sales: 650 }
            ],
            
            // 分類
            categories: [
                { id: 'all', name: '全部商品', icon: 'fa-box' },
                { id: 'cookies', name: '餅乾', icon: 'fa-cookie-bite' },
                { id: 'chips', name: '薯片', icon: 'fa-bacon' },
                { id: 'candy', name: '糖果', icon: 'fa-candy-cane' },
                { id: 'chocolate', name: '朱克力', icon: 'fa-heart' },
                { id: 'nuts', name: '堅果', icon: 'fa-seedling' },
                { id: 'dried-fruit', name: '果乾', icon: 'fa-apple-alt' }
            ],
            
            // 優惠活動
            promotions: [
                { id: 1, title: '新年大促銷', description: '全館滿千折百', discount: 100, minPurchase: 1000, endDate: '2024-02-29', image: 'https://via.placeholder.com/800x300?text=新年大促銷' },
                { id: 2, title: '會員日', description: '會員專屬85折', discount: 15, type: 'percentage', endDate: '2024-01-31', image: 'https://via.placeholder.com/800x300?text=會員日促銷活動' },
                { id: 3, title: '免運活動', description: '滿500免運費', freeShipping: true, minPurchase: 500, endDate: '2024-12-31', image: 'https://via.placeholder.com/800x300?text=免運活動' }
            ],
            
            // 獲取所有產品
            async getProducts(filters = {}) {
                await this.delay(300);
                let filtered = [...this.products];
                
                if (filters.category && filters.category !== 'all') {
                    filtered = filtered.filter(p => p.category === filters.category);
                }
                
                if (filters.search) {
                    const search = filters.search.toLowerCase();
                    filtered = filtered.filter(p => 
                        p.name.toLowerCase().includes(search) || 
                        p.description.toLowerCase().includes(search)
                    );
                }
                
                if (filters.sortBy) {
                    switch(filters.sortBy) {
                        case 'price-asc':
                            filtered.sort((a, b) => a.price - b.price);
                            break;
                        case 'price-desc':
                            filtered.sort((a, b) => b.price - a.price);
                            break;
                        case 'rating':
                            filtered.sort((a, b) => b.rating - a.rating);
                            break;
                        case 'sales':
                            filtered.sort((a, b) => b.sales - a.sales);
                            break;
                        default:
                            break;
                    }
                }
                
                return filtered;
            },
            
            // 獲取單一產品
            async getProduct(id) {
                await this.delay(200);
                return this.products.find(p => p.id === parseInt(id));
            },
            
            // 獲取分類
            async getCategories() {
                await this.delay(100);
                return this.categories;
            },
            
            // 獲取優惠活動
            async getPromotions() {
                await this.delay(200);
                return this.promotions;
            },
            
            // 用戶認證
            async login(email, password) {
                await this.delay(500);
                // 簡單的模擬登入
                if (email && password) {
                    const user = {
                        id: 1,
                        name: '王小明',
                        email: email,
                        phone: '0912-345-678',
                        joinDate: '2023-01-15',
                        points: 500
                    };
                    localStorage.setItem('user', JSON.stringify(user));
                    return { success: true, user };
                }
                return { success: false, message: '帳號或密碼錯誤' };
            },
            
            // 註冊
            async register(userData) {
                await this.delay(500);
                const user = {
                    id: Date.now(),
                    ...userData,
                    joinDate: new Date().toISOString().split('T')[0],
                    points: 0
                };
                localStorage.setItem('user', JSON.stringify(user));
                return { success: true, user };
            },
            
            // 獲取當前用戶
            getCurrentUser() {
                const userStr = localStorage.getItem('user');
                return userStr ? JSON.parse(userStr) : null;
            },
            
            // 登出
            logout() {
                localStorage.removeItem('user');
            },
            
            // 提交訂單
            async submitOrder(orderData) {
                await this.delay(800);
                const order = {
                    id: 'ORD' + Date.now(),
                    ...orderData,
                    date: new Date().toISOString(),
                    status: 'pending'
                };
                
                // 儲存訂單到 localStorage
                const orders = JSON.parse(localStorage.getItem('orders') || '[]');
                orders.unshift(order);
                localStorage.setItem('orders', JSON.stringify(orders));
                
                return { success: true, order };
            },
            
            // 獲取用戶訂單
            async getOrders() {
                await this.delay(300);
                return JSON.parse(localStorage.getItem('orders') || '[]');
            },
            
            // 獲取訂單詳情
            async getOrder(id) {
                await this.delay(200);
                const orders = JSON.parse(localStorage.getItem('orders') || '[]');
                return orders.find(o => o.id === id);
            }
        };
        
        // ==================== Context ====================
        const AppContext = createContext();
        
        const useApp = () => {
            const context = useContext(AppContext);
            if (!context) {
                throw new Error('useApp must be used within AppProvider');
            }
            return context;
        };
        
        // ==================== App Provider ====================
        const AppProvider = ({ children }) => {
            const [currentPage, setCurrentPage] = useState('home');
            const [cart, setCart] = useState(() => {
                const saved = localStorage.getItem('cart');
                return saved ? JSON.parse(saved) : [];
            });
            const [favorites, setFavorites] = useState(() => {
                const saved = localStorage.getItem('favorites');
                return saved ? JSON.parse(saved) : [];
            });
            const [user, setUser] = useState(DataService.getCurrentUser());
            const [toast, setToast] = useState(null);
            const [pageData, setPageData] = useState({});
            
            // 儲存購物車到 localStorage
            useEffect(() => {
                localStorage.setItem('cart', JSON.stringify(cart));
            }, [cart]);
            
            // 儲存收藏到 localStorage
            useEffect(() => {
                localStorage.setItem('favorites', JSON.stringify(favorites));
            }, [favorites]);
            
            // 導航到頁面
            const navigate = (page, data = {}) => {
                setCurrentPage(page);
                setPageData(data);
                window.scrollTo(0, 0);
            };
            
            // 添加到購物車
            const addToCart = (product, quantity = 1) => {
                setCart(prev => {
                    const existing = prev.find(item => item.id === product.id);
                    if (existing) {
                        return prev.map(item => 
                            item.id === product.id 
                                ? { ...item, quantity: item.quantity + quantity }
                                : item
                        );
                    }
                    return [...prev, { ...product, quantity }];
                });
                showToast('已加入購物車', 'success');
            };
            
            // 從購物車移除
            const removeFromCart = (productId) => {
                setCart(prev => prev.filter(item => item.id !== productId));
                showToast('已從購物車移除', 'info');
            };
            
            // 更新購物車數量
            const updateCartQuantity = (productId, quantity) => {
                if (quantity <= 0) {
                    removeFromCart(productId);
                    return;
                }
                setCart(prev => prev.map(item => 
                    item.id === productId ? { ...item, quantity } : item
                ));
            };
            
            // 清空購物車
            const clearCart = () => {
                setCart([]);
            };
            
            // 添加到收藏
            const toggleFavorite = (product) => {
                setFavorites(prev => {
                    const isFavorited = prev.some(item => item.id === product.id);
                    if (isFavorited) {
                        showToast('已從收藏移除', 'info');
                        return prev.filter(item => item.id !== product.id);
                    }
                    showToast('已加入收藏', 'success');
                    return [...prev, product];
                });
            };
            
            // 檢查是否已收藏
            const isFavorited = (productId) => {
                return favorites.some(item => item.id === productId);
            };
            
            // 登入
            const login = async (email, password) => {
                const result = await DataService.login(email, password);
                if (result.success) {
                    setUser(result.user);
                    showToast('登入成功', 'success');
                }
                return result;
            };
            
            // 註冊
            const register = async (userData) => {
                const result = await DataService.register(userData);
                if (result.success) {
                    setUser(result.user);
                    showToast('註冊成功', 'success');
                }
                return result;
            };
            
            // 登出
            const logout = () => {
                DataService.logout();
                setUser(null);
                showToast('已登出', 'info');
                navigate('home');
            };
            
            // 顯示提示
            const showToast = (message, type = 'info') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };
            
            // 計算購物車總計
            const cartTotal = useMemo(() => {
                return cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            }, [cart]);
            
            const value = {
                currentPage,
                navigate,
                cart,
                addToCart,
                removeFromCart,
                updateCartQuantity,
                clearCart,
                cartTotal,
                favorites,
                toggleFavorite,
                isFavorited,
                user,
                login,
                register,
                logout,
                toast,
                showToast,
                pageData
            };
            
            return <AppContext.Provider value={value}>{children}</AppContext.Provider>;
        };
        
        // ==================== Components ====================
        
        // Toast 通知
        const Toast = ({ message, type }) => {
            const bgColors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };
            
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                info: 'fa-info-circle',
                warning: 'fa-exclamation-triangle'
            };
            
            return (
                <div className={`toast ${bgColors[type]} text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-3`}>
                    <i className={`fas ${icons[type]}`}></i>
                    <span>{message}</span>
                </div>
            );
        };
        
        // Loading 組件
        const Loading = () => (
            <div className="flex justify-center items-center py-20">
                <div className="spinner"></div>
            </div>
        );
        
        // Chatbot 組件
        const Chatbot = () => {
            const [isOpen, setIsOpen] = useState(false);
            const [messages, setMessages] = useState([
                {
                    id: 1,
                    text: '您好！我是零食天堂的客服小助手，有什麼可以幫助您的嗎？',
                    sender: 'bot',
                    timestamp: new Date()
                }
            ]);
            const [inputText, setInputText] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            
            const quickReplies = [
                '推薦熱銷商品',
                '查看優惠活動',
                '運費怎麼計算',
                '如何追蹤訂單',
                '聯絡客服'
            ];
            
            const botResponses = {
                '推薦熱銷商品': '我們最熱銷的商品有：經典奶油餅乾、原味洋芋片、水果軟糖和黑巧克力。您可以在首頁的「熱銷商品」區塊查看詳細資訊！',
                '查看優惠活動': '我們目前有新年大促銷、會員專屬85折和滿350免運費等優惠活動。您可以在「優惠活動」頁面查看詳細資訊！',
                '運費怎麼計算': '訂單金額滿500元即可享有免運費優惠，未滿350元則運費為50元。',
                '如何追蹤訂單': '登入後在「會員中心」>「訂單查詢」中即可查看您的訂單狀態和物流資訊。',
                '聯絡客服': '您可以撥打客服專線 0800-123-456，或透過「聯絡我們」頁面發送訊息給我們，服務時間為週一至週日 09:00-21:00。',
                'default': '抱歉，我不太明白您的問題。您可以詢問關於商品推薦、優惠活動、運費計算或訂單查詢等問題。'
            };
            
            const handleSendMessage = () => {
                if (!inputText.trim()) return;
                
                // 添加用戶消息
                const userMessage = {
                    id: messages.length + 1,
                    text: inputText,
                    sender: 'user',
                    timestamp: new Date()
                };
                
                setMessages(prev => [...prev, userMessage]);
                setInputText('');
                setIsTyping(true);
                
                // 模擬機器人回應
                setTimeout(() => {
                    let response = botResponses.default;
                    
                    // 檢查是否有匹配的關鍵字
                    for (const key in botResponses) {
                        if (inputText.includes(key)) {
                            response = botResponses[key];
                            break;
                        }
                    }
                    
                    const botMessage = {
                        id: messages.length + 2,
                        text: response,
                        sender: 'bot',
                        timestamp: new Date()
                    };
                    
                    setMessages(prev => [...prev, botMessage]);
                    setIsTyping(false);
                }, 1500);
            };
            
            const handleQuickReply = (reply) => {
                setInputText(reply);
                // 自動發送快速回覆
                setTimeout(() => {
                    handleSendMessage();
                }, 100);
            };
            
            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    handleSendMessage();
                }
            };
            
            return (
                <div className="chatbot-container">
                    {isOpen && (
                        <div className="chatbot-window animate-fade-in">
                            <div className="chatbot-header">
                                <div className="flex items-center">
                                    <div className="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-3">
                                        <i className="fas fa-robot"></i>
                                    </div>
                                    <div>
                                        <h3 className="font-semibold">零食小助手</h3>
                                        <p className="text-xs opacity-80">線上為您服務</p>
                                    </div>
                                </div>
                                <button 
                                    onClick={() => setIsOpen(false)}
                                    className="text-white opacity-70 hover:opacity-100"
                                >
                                    <i className="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div className="chatbot-messages">
                                {messages.map(message => (
                                    <div 
                                        key={message.id} 
                                        className={`message ${message.sender === 'bot' ? 'bot-message' : 'user-message'}`}
                                    >
                                        {message.text}
                                    </div>
                                ))}
                                
                                {isTyping && (
                                    <div className="chatbot-typing">
                                        <div className="typing-dot"></div>
                                        <div className="typing-dot"></div>
                                        <div className="typing-dot"></div>
                                    </div>
                                )}
                                
                                {messages.length === 1 && (
                                    <div className="quick-reply">
                                        {quickReplies.map((reply, index) => (
                                            <button
                                                key={index}
                                                className="quick-reply-button"
                                                onClick={() => handleQuickReply(reply)}
                                            >
                                                {reply}
                                            </button>
                                        ))}
                                    </div>
                                )}
                            </div>
                            
                            <div className="chatbot-input">
                                <input
                                    type="text"
                                    value={inputText}
                                    onChange={(e) => setInputText(e.target.value)}
                                    onKeyPress={handleKeyPress}
                                    placeholder="輸入您的問題..."
                                />
                                <button onClick={handleSendMessage}>
                                    <i className="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    )}
                    
                    <div 
                        className="chatbot-button"
                        onClick={() => setIsOpen(!isOpen)}
                    >
                        <i className={`fas ${isOpen ? 'fa-times' : 'fa-comments'}`}></i>
                    </div>
                </div>
            );
        };
        
        // Header 組件
        const Header = () => {
            const { navigate, cart, user, logout } = useApp();
            const [showMenu, setShowMenu] = useState(false);
            
            const cartItemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            return (
                <header className="bg-white shadow-md sticky top-0 z-50">
                    <div className="container mx-auto px-4">
                        <div className="flex items-center justify-between py-4">
                            {/* Logo */}
                            <div 
                                className="flex items-center space-x-2 cursor-pointer"
                                onClick={() => navigate('home')}
                            >
                                <i className="fas fa-cookie-bite text-3xl text-primary"></i>
                                <span className="text-2xl font-bold text-primary">零食天堂</span>
                            </div>
                            
                            {/* Desktop Navigation */}
                            <nav className="hidden md:flex items-center space-x-6">
                                <a onClick={() => navigate('home')} className="text-gray-700 hover:text-primary cursor-pointer transition">首頁</a>
                                <a onClick={() => navigate('products')} className="text-gray-700 hover:text-primary cursor-pointer transition">所有商品</a>
                                <a onClick={() => navigate('promotions')} className="text-gray-700 hover:text-primary cursor-pointer transition">優惠活動</a>
                                <a onClick={() => navigate('about')} className="text-gray-700 hover:text-primary cursor-pointer transition">關於我們</a>
                                <a onClick={() => navigate('contact')} className="text-gray-700 hover:text-primary cursor-pointer transition">聯絡我們</a>
                            </nav>
                            
                            {/* Icons */}
                            <div className="flex items-center space-x-4">
                                <button 
                                    onClick={() => navigate('search')}
                                    className="text-gray-700 hover:text-primary transition"
                                >
                                    <i className="fas fa-search text-xl"></i>
                                </button>
                                
                                <button 
                                    onClick={() => navigate('favorites')}
                                    className="text-gray-700 hover:text-primary transition relative"
                                >
                                    <i className="fas fa-heart text-xl"></i>
                                </button>
                                
                                <button 
                                    onClick={() => navigate('cart')}
                                    className="text-gray-700 hover:text-primary transition relative"
                                >
                                    <i className="fas fa-shopping-cart text-xl"></i>
                                    {cartItemCount > 0 && (
                                        <span className="absolute -top-2 -right-2 bg-secondary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                                            {cartItemCount}
                                        </span>
                                    )}
                                </button>
                                
                                {user ? (
                                    <div className="relative group">
                                        <button className="text-gray-700 hover:text-primary transition">
                                            <i className="fas fa-user text-xl"></i>
                                        </button>
                                        <div className="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 hidden group-hover:block">
                                            <a onClick={() => navigate('profile')} className="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">會員中心</a>
                                            <a onClick={() => navigate('orders')} className="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">訂單查詢</a>
                                            <a onClick={logout} className="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">登出</a>
                                        </div>
                                    </div>
                                ) : (
                                    <button 
                                        onClick={() => navigate('login')}
                                        className="text-gray-700 hover:text-primary transition"
                                    >
                                        <i className="fas fa-user text-xl"></i>
                                    </button>
                                )}
                                
                                {/* Mobile Menu Toggle */}
                                <button 
                                    className="md:hidden text-gray-700"
                                    onClick={() => setShowMenu(!showMenu)}
                                >
                                    <i className={`fas ${showMenu ? 'fa-times' : 'fa-bars'} text-xl`}></i>
                                </button>
                            </div>
                        </div>
                        
                        {/* Mobile Navigation */}
                        {showMenu && (
                            <nav className="md:hidden py-4 border-t animate-slide-in">
                                <a onClick={() => { navigate('home'); setShowMenu(false); }} className="block py-2 text-gray-700 hover:text-primary cursor-pointer">首頁</a>
                                <a onClick={() => { navigate('products'); setShowMenu(false); }} className="block py-2 text-gray-700 hover:text-primary cursor-pointer">所有商品</a>
                                <a onClick={() => { navigate('promotions'); setShowMenu(false); }} className="block py-2 text-gray-700 hover:text-primary cursor-pointer">優惠活動</a>
                                <a onClick={() => { navigate('about'); setShowMenu(false); }} className="block py-2 text-gray-700 hover:text-primary cursor-pointer">關於我們</a>
                                <a onClick={() => { navigate('contact'); setShowMenu(false); }} className="block py-2 text-gray-700 hover:text-primary cursor-pointer">聯絡我們</a>
                            </nav>
                        )}
                    </div>
                </header>
            );
        };
        
        // Footer 組件
        const Footer = () => {
            const { navigate } = useApp();
            
            return (
                <footer className="bg-gray-900 text-white mt-20">
                    <div className="container mx-auto px-4 py-12">
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
                            <div>
                                <h3 className="text-xl font-bold mb-4 flex items-center">
                                    <i className="fas fa-cookie-bite mr-2"></i>
                                    零食天堂
                                </h3>
                                <p className="text-gray-400">
                                    提供最優質的零食，讓您的生活更甜蜜
                                </p>
                            </div>
                            
                            <div>
                                <h4 className="text-lg font-semibold mb-4">快速連結</h4>
                                <ul className="space-y-2">
                                    <li><a onClick={() => navigate('about')} className="text-gray-400 hover:text-white cursor-pointer transition">關於我們</a></li>
                                    <li><a onClick={() => navigate('products')} className="text-gray-400 hover:text-white cursor-pointer transition">所有商品</a></li>
                                    <li><a onClick={() => navigate('promotions')} className="text-gray-400 hover:text-white cursor-pointer transition">優惠活動</a></li>
                                    <li><a onClick={() => navigate('faq')} className="text-gray-400 hover:text-white cursor-pointer transition">常見問題</a></li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 className="text-lg font-semibold mb-4">客戶服務</h4>
                                <ul className="space-y-2">
                                    <li><a onClick={() => navigate('contact')} className="text-gray-400 hover:text-white cursor-pointer transition">聯絡我們</a></li>
                                    <li><a onClick={() => navigate('orders')} className="text-gray-400 hover:text-white cursor-pointer transition">訂單查詢</a></li>
                                    <li><a className="text-gray-400 hover:text-white cursor-pointer transition">退換貨政策</a></li>
                                    <li><a className="text-gray-400 hover:text-white cursor-pointer transition">隱私權政策</a></li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 className="text-lg font-semibold mb-4">聯絡資訊</h4>
                                <ul className="space-y-2 text-gray-400">
                                    <li><i className="fas fa-phone mr-2"></i> 0800-123-456</li>
                                    <li><i className="fas fa-envelope mr-2"></i> service@snackheaven.com</li>
                                    <li><i className="fas fa-map-marker-alt mr-2"></i> 九龍尖沙咀東科學館道16號華懋廣場UG3樓</li>
                                </ul>
                                <div className="flex space-x-4 mt-4">
                                    <a href="#" className="text-gray-400 hover:text-white transition"><i className="fab fa-facebook text-2xl"></i></a>
                                    <a href="#" className="text-gray-400 hover:text-white transition"><i className="fab fa-instagram text-2xl"></i></a>
                                    <a href="#" className="text-gray-400 hover:text-white transition"><i className="fab fa-line text-2xl"></i></a>
                                </div>
                            </div>
                        </div>
                        
                        <div className="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                            <p>&copy; 2024 零食天堂. All rights reserved.</p>
                        </div>
                    </div>
                </footer>
            );
        };
        
        // 產品卡片組件
        const ProductCard = ({ product }) => {
            const { navigate, addToCart, toggleFavorite, isFavorited } = useApp();
            const favorited = isFavorited(product.id);
            
            return (
                <div className="product-card bg-white rounded-lg shadow-md overflow-hidden">
                    <div className="relative">
                        <img 
                            src={product.image} 
                            alt={product.name}
                            className="w-full h-48 object-cover cursor-pointer"
                            onClick={() => navigate('product-detail', { productId: product.id })}
                        />
                        <button 
                            onClick={() => toggleFavorite(product)}
                            className="absolute top-2 right-2 bg-white rounded-full w-10 h-10 flex items-center justify-center shadow-md hover:scale-110 transition"
                        >
                            <i className={`fas fa-heart ${favorited ? 'text-secondary' : 'text-gray-400'}`}></i>
                        </button>
                        {product.stock < 10 && (
                            <span className="absolute top-2 left-2 bg-secondary text-white px-2 py-1 rounded text-xs">
                                剩餘 {product.stock} 件
                            </span>
                        )}
                    </div>
                    
                    <div className="p-4">
                        <h3 
                            className="text-lg font-semibold mb-2 cursor-pointer hover:text-primary transition"
                            onClick={() => navigate('product-detail', { productId: product.id })}
                        >
                            {product.name}
                        </h3>
                        <p className="text-gray-600 text-sm mb-3">{product.description}</p>
                        
                        <div className="flex items-center mb-3">
                            <div className="flex text-warning">
                                {[...Array(5)].map((_, i) => (
                                    <i key={i} className={`fas fa-star ${i < Math.floor(product.rating) ? '' : 'text-gray-300'}`}></i>
                                ))}
                            </div>
                            <span className="text-gray-600 text-sm ml-2">({product.rating})</span>
                        </div>
                        
                        <div className="flex items-center justify-between">
                            <span className="text-2xl font-bold text-primary">HK$ {product.price}</span>
                            <button 
                                onClick={() => addToCart(product)}
                                className="btn-primary bg-primary text-white px-4 py-2 rounded-lg hover:bg-opacity-90"
                            >
                                <i className="fas fa-cart-plus mr-2"></i>
                                加入購物車
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ==================== Pages ====================
        
        // 首頁
        const HomePage = () => {
            const { navigate } = useApp();
            const [products, setProducts] = useState([]);
            const [categories, setCategories] = useState([]);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                loadData();
            }, []);
            
            const loadData = async () => {
                setLoading(true);
                const [productsData, categoriesData] = await Promise.all([
                    DataService.getProducts({ sortBy: 'sales' }),
                    DataService.getCategories()
                ]);
                setProducts(productsData.slice(0, 8));
                setCategories(categoriesData);
                setLoading(false);
            };
            
            return (
                <div className="animate-fade-in">
                    {/* 導覽頁區域 */}
                    <section className="bg-gradient-to-r from-primary to-purple-600 text-white py-20">
                        <div className="container mx-auto px-4 text-center">
                            <h1 className="text-4xl md:text-6xl font-bold mb-4">歡迎來到零食天堂</h1>
                            <p className="text-xl md:text-2xl mb-8">精選優質零食，滿足您的味蕾</p>
                            <button 
                                onClick={() => navigate('products')}
                                className="btn-primary bg-white text-primary px-8 py-3 rounded-full text-lg font-semibold hover:shadow-lg"
                            >
                                立即選購
                            </button>
                        </div>
                    </section>
                    
                    {/* Categories */}
                    <section className="container mx-auto px-4 py-16">
                        <h2 className="text-3xl font-bold text-center mb-10">商品分類</h2>
                        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                            {categories.filter(c => c.id !== 'all').map(category => (
                                <div 
                                    key={category.id}
                                    onClick={() => navigate('category', { category: category.id })}
                                    className="bg-white rounded-lg shadow-md p-6 text-center cursor-pointer hover:shadow-lg transition transform hover:-translate-y-1"
                                >
                                    <i className={`fas ${category.icon} text-4xl text-primary mb-3`}></i>
                                    <h3 className="font-semibold">{category.name}</h3>
                                </div>
                            ))}
                        </div>
                    </section>
                    
                    {/* Hot Products */}
                    <section className="container mx-auto px-4 py-16 bg-gray-50">
                        <div className="flex items-center justify-between mb-10">
                            <h2 className="text-3xl font-bold">熱銷商品</h2>
                            <button 
                                onClick={() => navigate('products')}
                                className="text-primary hover:underline"
                            >
                                查看更多 <i className="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                        
                        {loading ? (
                            <Loading />
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                {products.map(product => (
                                    <ProductCard key={product.id} product={product} />
                                ))}
                            </div>
                        )}
                    </section>
                    
                    {/* Features */}
                    <section className="container mx-auto px-4 py-16">
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <div className="text-center">
                                <div className="bg-primary bg-opacity-10 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
                                    <i className="fas fa-shipping-fast text-3xl text-primary"></i>
                                </div>
                                <h3 className="text-xl font-semibold mb-2">快速配送</h3>
                                <p className="text-gray-600">24小時內快速出貨</p>
                            </div>
                            
                            <div className="text-center">
                                <div className="bg-primary bg-opacity-10 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
                                    <i className="fas fa-shield-alt text-3xl text-primary"></i>
                                </div>
                                <h3 className="text-xl font-semibold mb-2">品質保證</h3>
                                <p className="text-gray-600">嚴選優質商品</p>
                            </div>
                            
                            <div className="text-center">
                                <div className="bg-primary bg-opacity-10 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
                                    <i className="fas fa-headset text-3xl text-primary"></i>
                                </div>
                                <h3 className="text-xl font-semibold mb-2">貼心客服</h3>
                                <p className="text-gray-600">專業團隊隨時服務</p>
                            </div>
                        </div>
                    </section>
                    
                    {/* Chatbot - 只在首頁顯示 */}
                    <Chatbot />
                </div>
            );
        };
        
        // 所有商品頁
        const ProductsPage = () => {
            const [products, setProducts] = useState([]);
            const [categories, setCategories] = useState([]);
            const [loading, setLoading] = useState(true);
            const [selectedCategory, setSelectedCategory] = useState('all');
            const [sortBy, setSortBy] = useState('');
            
            useEffect(() => {
                loadData();
            }, []);
            
            useEffect(() => {
                filterProducts();
            }, [selectedCategory, sortBy]);
            
            const loadData = async () => {
                const [productsData, categoriesData] = await Promise.all([
                    DataService.getProducts(),
                    DataService.getCategories()
                ]);
                setProducts(productsData);
                setCategories(categoriesData);
                setLoading(false);
            };
            
            const filterProducts = async () => {
                setLoading(true);
                const filtered = await DataService.getProducts({
                    category: selectedCategory,
                    sortBy: sortBy
                });
                setProducts(filtered);
                setLoading(false);
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">所有商品</h1>
                    
                    <div className="flex flex-col md:flex-row gap-8">
                        {/* Filters Sidebar */}
                        <div className="md:w-64">
                            <div className="bg-white rounded-lg shadow-md p-6 sticky top-24">
                                <h3 className="font-semibold text-lg mb-4">商品分類</h3>
                                <div className="space-y-2">
                                    {categories.map(category => (
                                        <button
                                            key={category.id}
                                            onClick={() => setSelectedCategory(category.id)}
                                            className={`w-full text-left px-4 py-2 rounded-lg transition ${
                                                selectedCategory === category.id 
                                                    ? 'bg-primary text-white' 
                                                    : 'hover:bg-gray-100'
                                            }`}
                                        >
                                            <i className={`fas ${category.icon} mr-2`}></i>
                                            {category.name}
                                        </button>
                                    ))}
                                </div>
                                
                                <h3 className="font-semibold text-lg mb-4 mt-8">排序方式</h3>
                                <select 
                                    value={sortBy}
                                    onChange={(e) => setSortBy(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg text-base"
                                >
                                    <option value="">預設排序</option>
                                    <option value="price-asc">價格：低到高</option>
                                    <option value="price-desc">價格：高到低</option>
                                    <option value="rating">評分最高</option>
                                    <option value="sales">最熱銷</option>
                                </select>
                            </div>
                        </div>
                        
                        {/* Products Grid */}
                        <div className="flex-1">
                            {loading ? (
                                <Loading />
                            ) : products.length === 0 ? (
                                <div className="text-center py-20">
                                    <i className="fas fa-box-open text-6xl text-gray-300 mb-4"></i>
                                    <p className="text-gray-500">沒有找到商品</p>
                                </div>
                            ) : (
                                <>
                                    <div className="mb-4 text-gray-600">
                                        找到 {products.length} 件商品
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        {products.map(product => (
                                            <ProductCard key={product.id} product={product} />
                                        ))}
                                    </div>
                                </>
                            )}
                        </div>
                    </div>
                </div>
            );
        };
        
        // 商品詳情頁
        const ProductDetailPage = () => {
            const { pageData, addToCart, toggleFavorite, isFavorited, navigate } = useApp();
            const [product, setProduct] = useState(null);
            const [quantity, setQuantity] = useState(1);
            const [loading, setLoading] = useState(true);
            const [relatedProducts, setRelatedProducts] = useState([]);
            
            useEffect(() => {
                loadProduct();
            }, [pageData.productId]);
            
            const loadProduct = async () => {
                setLoading(true);
                const productData = await DataService.getProduct(pageData.productId);
                setProduct(productData);
                
                // 載入相關商品
                const related = await DataService.getProducts({ 
                    category: productData.category 
                });
                setRelatedProducts(related.filter(p => p.id !== productData.id).slice(0, 4));
                
                setLoading(false);
            };
            
            if (loading) return <Loading />;
            if (!product) return <div className="container mx-auto px-4 py-8">找不到商品</div>;
            
            const favorited = isFavorited(product.id);
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    {/* Breadcrumb */}
                    <div className="text-sm text-gray-600 mb-6">
                        <span onClick={() => navigate('home')} className="cursor-pointer hover:text-primary">首頁</span>
                        <span className="mx-2">/</span>
                        <span onClick={() => navigate('products')} className="cursor-pointer hover:text-primary">所有商品</span>
                        <span className="mx-2">/</span>
                        <span>{product.name}</span>
                    </div>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                        {/* Product Image */}
                        <div>
                            <img 
                                src={product.image} 
                                alt={product.name}
                                className="w-full rounded-lg shadow-lg"
                            />
                        </div>
                        
                        {/* Product Info */}
                        <div>
                            <h1 className="text-3xl font-bold mb-4">{product.name}</h1>
                            
                            <div className="flex items-center mb-4">
                                <div className="flex text-warning">
                                    {[...Array(5)].map((_, i) => (
                                        <i key={i} className={`fas fa-star ${i < Math.floor(product.rating) ? '' : 'text-gray-300'}`}></i>
                                    ))}
                                </div>
                                <span className="text-gray-600 ml-2">({product.rating})</span>
                                <span className="text-gray-600 ml-4">已售出 {product.sales} 件</span>
                            </div>
                            
                            <div className="text-4xl font-bold text-primary mb-6">
                                HK$ {product.price}
                            </div>
                            
                            <p className="text-gray-700 mb-6 leading-relaxed">
                                {product.description}
                            </p>
                            
                            <div className="mb-6">
                                <span className="text-gray-700">庫存：</span>
                                <span className={`font-semibold ${product.stock < 10 ? 'text-secondary' : 'text-green-600'}`}>
                                    {product.stock} 件
                                </span>
                            </div>
                            
                            {/* Quantity Selector */}
                            <div className="mb-6">
                                <label className="block text-gray-700 mb-2">數量</label>
                                <div className="flex items-center space-x-4">
                                    <button 
                                        onClick={() => setQuantity(Math.max(1, quantity - 1))}
                                        className="w-10 h-10 border rounded-lg hover:bg-gray-100"
                                    >
                                        <i className="fas fa-minus"></i>
                                    </button>
                                    <input 
                                        type="number" 
                                        value={quantity}
                                        onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value) || 1))}
                                        className="w-20 text-center border rounded-lg py-2 text-base"
                                        min="1"
                                        max={product.stock}
                                    />
                                    <button 
                                        onClick={() => setQuantity(Math.min(product.stock, quantity + 1))}
                                        className="w-10 h-10 border rounded-lg hover:bg-gray-100"
                                    >
                                        <i className="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            
                            {/* Action Buttons */}
                            <div className="flex space-x-4 mb-6">
                                <button 
                                    onClick={() => addToCart(product, quantity)}
                                    className="btn-primary flex-1 bg-primary text-white py-3 rounded-lg font-semibold hover:bg-opacity-90"
                                >
                                    <i className="fas fa-cart-plus mr-2"></i>
                                    加入購物車
                                </button>
                                <button 
                                    onClick={() => toggleFavorite(product)}
                                    className={`w-14 h-14 border-2 rounded-lg ${favorited ? 'border-secondary text-secondary' : 'border-gray-300 text-gray-600'} hover:scale-110 transition`}
                                >
                                    <i className="fas fa-heart text-xl"></i>
                                </button>
                            </div>
                            
                            <button 
                                onClick={() => {
                                    addToCart(product, quantity);
                                    navigate('checkout');
                                }}
                                className="w-full bg-secondary text-white py-3 rounded-lg font-semibold hover:bg-opacity-90"
                            >
                                立即購買
                            </button>
                        </div>
                    </div>
                    
                    {/* Related Products */}
                    {relatedProducts.length > 0 && (
                        <section className="mt-16">
                            <h2 className="text-2xl font-bold mb-6">相關商品</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                {relatedProducts.map(p => (
                                    <ProductCard key={p.id} product={p} />
                                ))}
                            </div>
                        </section>
                    )}
                </div>
            );
        };
        
        // 分類頁面
        const CategoryPage = () => {
            const { pageData, navigate } = useApp();
            const [products, setProducts] = useState([]);
            const [category, setCategory] = useState(null);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                loadData();
            }, [pageData.category]);
            
            const loadData = async () => {
                setLoading(true);
                const [productsData, categoriesData] = await Promise.all([
                    DataService.getProducts({ category: pageData.category }),
                    DataService.getCategories()
                ]);
                setProducts(productsData);
                setCategory(categoriesData.find(c => c.id === pageData.category));
                setLoading(false);
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <div className="text-sm text-gray-600 mb-6">
                        <span onClick={() => navigate('home')} className="cursor-pointer hover:text-primary">首頁</span>
                        <span className="mx-2">/</span>
                        <span>{category?.name}</span>
                    </div>
                    
                    <div className="mb-8">
                        <h1 className="text-3xl font-bold flex items-center">
                            {category && <i className={`fas ${category.icon} mr-3 text-primary`}></i>}
                            {category?.name}
                        </h1>
                    </div>
                    
                    {loading ? (
                        <Loading />
                    ) : (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            {products.map(product => (
                                <ProductCard key={product.id} product={product} />
                            ))}
                        </div>
                    )}
                </div>
            );
        };
        
        // 購物車頁
        const CartPage = () => {
            const { cart, updateCartQuantity, removeFromCart, cartTotal, navigate } = useApp();
            
            const shippingFee = cartTotal >= 500 ? 0 : 60;
            const total = cartTotal + shippingFee;
            
            if (cart.length === 0) {
                return (
                    <div className="container mx-auto px-4 py-20 text-center animate-fade-in">
                        <i className="fas fa-shopping-cart text-6xl text-gray-300 mb-4"></i>
                        <h2 className="text-2xl font-semibold mb-4">購物車是空的</h2>
                        <p className="text-gray-600 mb-8">快去選購喜歡的商品吧！</p>
                        <button 
                            onClick={() => navigate('products')}
                            className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                        >
                            開始購物
                        </button>
                    </div>
                );
            }
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">購物車</h1>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        {/* Cart Items */}
                        <div className="lg:col-span-2">
                            <div className="bg-white rounded-lg shadow-md">
                                {cart.map(item => (
                                    <div key={item.id} className="flex items-center p-6 border-b last:border-b-0">
                                        <img 
                                            src={item.image} 
                                            alt={item.name}
                                            className="w-24 h-24 object-cover rounded-lg cursor-pointer"
                                            onClick={() => navigate('product-detail', { productId: item.id })}
                                        />
                                        
                                        <div className="flex-1 ml-6">
                                            <h3 
                                                className="font-semibold text-lg mb-2 cursor-pointer hover:text-primary"
                                                onClick={() => navigate('product-detail', { productId: item.id })}
                                            >
                                                {item.name}
                                            </h3>
                                            <p className="text-gray-600 mb-2">{item.description}</p>
                                            <p className="text-primary font-bold text-xl">HK$ {item.price}</p>
                                        </div>
                                        
                                        <div className="flex items-center space-x-6">
                                            <div className="flex items-center space-x-2">
                                                <button 
                                                    onClick={() => updateCartQuantity(item.id, item.quantity - 1)}
                                                    className="w-8 h-8 border rounded hover:bg-gray-100"
                                                >
                                                    <i className="fas fa-minus text-sm"></i>
                                                </button>
                                                <span className="w-12 text-center font-semibold">{item.quantity}</span>
                                                <button 
                                                    onClick={() => updateCartQuantity(item.id, item.quantity + 1)}
                                                    className="w-8 h-8 border rounded hover:bg-gray-100"
                                                >
                                                    <i className="fas fa-plus text-sm"></i>
                                                </button>
                                            </div>
                                            
                                            <button 
                                                onClick={() => removeFromCart(item.id)}
                                                className="text-secondary hover:text-red-700"
                                            >
                                                <i className="fas fa-trash text-xl"></i>
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        {/* Order Summary */}
                        <div>
                            <div className="bg-white rounded-lg shadow-md p-6 sticky top-24">
                                <h2 className="text-xl font-bold mb-6">訂單摘要</h2>
                                
                                <div className="space-y-4 mb-6">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">小計</span>
                                        <span className="font-semibold">HK$ {cartTotal}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">運費</span>
                                        <span className="font-semibold">
                                            {shippingFee === 0 ? '免運' : `HK$ ${shippingFee}`}
                                        </span>
                                    </div>
                                    {cartTotal < 500 && (
                                        <p className="text-sm text-gray-500">
                                            再買 HK$ {500 - cartTotal} 即可免運
                                        </p>
                                    )}
                                    <div className="border-t pt-4 flex justify-between text-xl">
                                        <span className="font-bold">總計</span>
                                        <span className="font-bold text-primary">HK$ {total}</span>
                                    </div>
                                </div>
                                
                                <button 
                                    onClick={() => navigate('checkout')}
                                    className="btn-primary w-full bg-primary text-white py-3 rounded-lg font-semibold"
                                >
                                    前往結帳
                                </button>
                                
                                <button 
                                    onClick={() => navigate('products')}
                                    className="w-full mt-3 border-2 border-primary text-primary py-3 rounded-lg font-semibold hover:bg-primary hover:text-white transition"
                                >
                                    繼續購物
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 結帳頁
        const CheckoutPage = () => {
            const { cart, cartTotal, user, navigate, clearCart, showToast } = useApp();
            const [formData, setFormData] = useState({
                name: user?.name || '',
                email: user?.email || '',
                phone: user?.phone || '',
                address: '',
                payment: 'credit',
                note: ''
            });
            const [submitting, setSubmitting] = useState(false);
            
            const shippingFee = cartTotal >= 500 ? 0 : 60;
            const total = cartTotal + shippingFee;
            
            if (cart.length === 0) {
                return (
                    <div className="container mx-auto px-4 py-20 text-center">
                        <p className="text-xl mb-4">購物車是空的</p>
                        <button 
                            onClick={() => navigate('products')}
                            className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                        >
                            開始購物
                        </button>
                    </div>
                );
            }
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!formData.name || !formData.email || !formData.phone || !formData.address) {
                    showToast('請填寫所有必填欄位', 'error');
                    return;
                }
                
                setSubmitting(true);
                
                const orderData = {
                    items: cart,
                    customer: formData,
                    subtotal: cartTotal,
                    shipping: shippingFee,
                    total: total
                };
                
                const result = await DataService.submitOrder(orderData);
                
                if (result.success) {
                    clearCart();
                    navigate('order-confirm', { order: result.order });
                } else {
                    showToast('訂單提交失敗，請稍後再試', 'error');
                }
                
                setSubmitting(false);
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">結帳</h1>
                    
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            {/* Customer Info */}
                            <div className="lg:col-span-2">
                                <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                                    <h2 className="text-xl font-bold mb-6">收件資訊</h2>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-gray-700 mb-2">姓名 *</label>
                                            <input 
                                                type="text"
                                                value={formData.name}
                                                onChange={(e) => setFormData({...formData, name: e.target.value})}
                                                className="w-full px-4 py-2 border rounded-lg text-base"
                                                required
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-gray-700 mb-2">Email *</label>
                                            <input 
                                                type="email"
                                                value={formData.email}
                                                onChange={(e) => setFormData({...formData, email: e.target.value})}
                                                className="w-full px-4 py-2 border rounded-lg text-base"
                                                required
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-gray-700 mb-2">電話 *</label>
                                            <input 
                                                type="tel"
                                                value={formData.phone}
                                                onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                                className="w-full px-4 py-2 border rounded-lg text-base"
                                                required
                                            />
                                        </div>
                                        
                                        <div className="md:col-span-2">
                                            <label className="block text-gray-700 mb-2">地址 *</label>
                                            <input 
                                                type="text"
                                                value={formData.address}
                                                onChange={(e) => setFormData({...formData, address: e.target.value})}
                                                className="w-full px-4 py-2 border rounded-lg text-base"
                                                required
                                            />
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                                    <h2 className="text-xl font-bold mb-6">付款方式</h2>
                                    
                                    <div className="space-y-3">
                                        <label className="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                                            <input 
                                                type="radio"
                                                name="payment"
                                                value="credit"
                                                checked={formData.payment === 'credit'}
                                                onChange={(e) => setFormData({...formData, payment: e.target.value})}
                                                className="mr-3"
                                            />
                                            <i className="fas fa-credit-card mr-3 text-primary"></i>
                                            <span>信用卡</span>
                                        </label>
                                        
                                        <label className="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                                            <input 
                                                type="radio"
                                                name="payment"
                                                value="atm"
                                                checked={formData.payment === 'atm'}
                                                onChange={(e) => setFormData({...formData, payment: e.target.value})}
                                                className="mr-3"
                                            />
                                            <i className="fas fa-university mr-3 text-primary"></i>
                                            <span>Alipay / Payme / WeChat Pay</span>
                                        </label>
                                        
                                        <label className="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                                            <input 
                                                type="radio"
                                                name="payment"
                                                value="cod"
                                                checked={formData.payment === 'cod'}
                                                onChange={(e) => setFormData({...formData, payment: e.target.value})}
                                                className="mr-3"
                                            />
                                            <i className="fas fa-money-bill-wave mr-3 text-primary"></i>
                                            <span>貨到付款</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div className="bg-white rounded-lg shadow-md p-6">
                                    <h2 className="text-xl font-bold mb-6">備註</h2>
                                    <textarea 
                                        value={formData.note}
                                        onChange={(e) => setFormData({...formData, note: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        rows="4"
                                        placeholder="有什麼想告訴我們的嗎？"
                                    ></textarea>
                                </div>
                            </div>
                            
                            {/* Order Summary */}
                            <div>
                                <div className="bg-white rounded-lg shadow-md p-6 sticky top-24">
                                    <h2 className="text-xl font-bold mb-6">訂單摘要</h2>
                                    
                                    <div className="space-y-4 mb-6 max-h-64 overflow-y-auto">
                                        {cart.map(item => (
                                            <div key={item.id} className="flex items-center space-x-3">
                                                <img src={item.image} alt={item.name} className="w-16 h-16 object-cover rounded" />
                                                <div className="flex-1">
                                                    <p className="font-semibold text-sm">{item.name}</p>
                                                    <p className="text-gray-600 text-sm">x {item.quantity}</p>
                                                </div>
                                                <span className="font-semibold">HK$ {item.price * item.quantity}</span>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    <div className="border-t pt-4 space-y-3 mb-6">
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">小計</span>
                                            <span className="font-semibold">HK$ {cartTotal}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-600">運費</span>
                                            <span className="font-semibold">
                                                {shippingFee === 0 ? '免運' : `HK$ ${shippingFee}`}
                                            </span>
                                        </div>
                                        <div className="flex justify-between text-xl font-bold border-t pt-3">
                                            <span>總計</span>
                                            <span className="text-primary">HK$ {total}</span>
                                        </div>
                                    </div>
                                    
                                    <button 
                                        type="submit"
                                        disabled={submitting}
                                        className="btn-primary w-full bg-primary text-white py-3 rounded-lg font-semibold disabled:opacity-50"
                                    >
                                        {submitting ? (
                                            <>
                                                <i className="fas fa-spinner fa-spin mr-2"></i>
                                                處理中...
                                            </>
                                        ) : (
                                            '確認訂單'
                                        )}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            );
        };
        
        // 訂單確認頁
        const OrderConfirmPage = () => {
            const { pageData, navigate } = useApp();
            const order = pageData.order;
            
            if (!order) {
                return (
                    <div className="container mx-auto px-4 py-20 text-center">
                        <p className="text-xl mb-4">找不到訂單資訊</p>
                        <button 
                            onClick={() => navigate('home')}
                            className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                        >
                            返回首頁
                        </button>
                    </div>
                );
            }
            
            const paymentMethods = {
                credit: '信用卡',
                atm: 'ATM 轉帳',
                cod: '貨到付款'
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <div className="max-w-3xl mx-auto">
                        <div className="bg-white rounded-lg shadow-md p-8 text-center mb-8">
                            <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i className="fas fa-check text-4xl text-green-600"></i>
                            </div>
                            <h1 className="text-3xl font-bold mb-2">訂單已確認！</h1>
                            <p className="text-gray-600 mb-4">感謝您的購買</p>
                            <p className="text-lg">訂單編號：<span className="font-semibold text-primary">{order.id}</span></p>
                        </div>
                        
                        <div className="bg-white rounded-lg shadow-md p-8 mb-8">
                            <h2 className="text-xl font-bold mb-6">訂單詳情</h2>
                            
                            <div className="space-y-4 mb-6">
                                {order.items.map(item => (
                                    <div key={item.id} className="flex items-center justify-between border-b pb-4">
                                        <div className="flex items-center">
                                            <img src={item.image} alt={item.name} className="w-16 h-16 object-cover rounded mr-4" />
                                            <div>
                                                <p className="font-semibold">{item.name}</p>
                                                <p className="text-gray-600 text-sm">x {item.quantity}</p>
                                            </div>
                                        </div>
                                        <span className="font-semibold">HK$ {item.price * item.quantity}</span>
                                    </div>
                                ))}
                            </div>
                            
                            <div className="border-t pt-4 space-y-2">
                                <div className="flex justify-between">
                                    <span className="text-gray-600">小計</span>
                                    <span>HK$ {order.subtotal}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-600">運費</span>
                                    <span>{order.shipping === 0 ? '免運' : `HK$ ${order.shipping}`}</span>
                                </div>
                                <div className="flex justify-between text-xl font-bold border-t pt-2">
                                    <span>總計</span>
                                    <span className="text-primary">HK$ {order.total}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div className="bg-white rounded-lg shadow-md p-8 mb-8">
                            <h2 className="text-xl font-bold mb-6">收件資訊</h2>
                            <div className="space-y-2">
                                <p><span className="text-gray-600">姓名：</span>{order.customer.name}</p>
                                <p><span className="text-gray-600">Email：</span>{order.customer.email}</p>
                                <p><span className="text-gray-600">電話：</span>{order.customer.phone}</p>
                                <p><span className="text-gray-600">地址：</span>{order.customer.address}</p>
                                <p><span className="text-gray-600">付款方式：</span>{paymentMethods[order.customer.payment]}</p>
                            </div>
                        </div>
                        
                        <div className="flex space-x-4">
                            <button 
                                onClick={() => navigate('orders')}
                                className="flex-1 bg-primary text-white py-3 rounded-lg font-semibold hover:bg-opacity-90"
                            >
                                查看訂單
                            </button>
                            <button 
                                onClick={() => navigate('home')}
                                className="flex-1 border-2 border-primary text-primary py-3 rounded-lg font-semibold hover:bg-primary hover:text-white transition"
                            >
                                返回首頁
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 登入/註冊頁
        const LoginPage = () => {
            const { login, register, navigate, user } = useApp();
            const [isLogin, setIsLogin] = useState(true);
            const [formData, setFormData] = useState({
                name: '',
                email: '',
                password: '',
                phone: ''
            });
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            
            // 如果已登入，重定向到會員中心
            useEffect(() => {
                if (user) {
                    navigate('profile');
                }
            }, [user]);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);
                
                try {
                    if (isLogin) {
                        const result = await login(formData.email, formData.password);
                        if (!result.success) {
                            setError(result.message);
                        } else {
                            navigate('profile');
                        }
                    } else {
                        if (!formData.name || !formData.phone) {
                            setError('請填寫所有欄位');
                            setLoading(false);
                            return;
                        }
                        const result = await register(formData);
                        if (result.success) {
                            navigate('profile');
                        }
                    }
                } catch (err) {
                    setError('發生錯誤，請稍後再試');
                }
                
                setLoading(false);
            };
            
            return (
                <div className="container mx-auto px-4 py-12 animate-fade-in">
                    <div className="max-w-md mx-auto bg-white rounded-lg shadow-md p-8">
                        <h1 className="text-3xl font-bold text-center mb-8">
                            {isLogin ? '會員登入' : '會員註冊'}
                        </h1>
                        
                        {error && (
                            <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                                {error}
                            </div>
                        )}
                        
                        <form onSubmit={handleSubmit} className="space-y-4">
                            {!isLogin && (
                                <div>
                                    <label className="block text-gray-700 mb-2">姓名</label>
                                    <input 
                                        type="text"
                                        value={formData.name}
                                        onChange={(e) => setFormData({...formData, name: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        required={!isLogin}
                                    />
                                </div>
                            )}
                            
                            <div>
                                <label className="block text-gray-700 mb-2">Email</label>
                                <input 
                                    type="email"
                                    value={formData.email}
                                    onChange={(e) => setFormData({...formData, email: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg text-base"
                                    required
                                />
                            </div>
                            
                            <div>
                                <label className="block text-gray-700 mb-2">密碼</label>
                                <input 
                                    type="password"
                                    value={formData.password}
                                    onChange={(e) => setFormData({...formData, password: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg text-base"
                                    required
                                />
                            </div>
                            
                            {!isLogin && (
                                <div>
                                    <label className="block text-gray-700 mb-2">電話</label>
                                    <input 
                                        type="tel"
                                        value={formData.phone}
                                        onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        required={!isLogin}
                                    />
                                </div>
                            )}
                            
                            <button 
                                type="submit"
                                disabled={loading}
                                className="btn-primary w-full bg-primary text-white py-3 rounded-lg font-semibold disabled:opacity-50"
                            >
                                {loading ? (
                                    <>
                                        <i className="fas fa-spinner fa-spin mr-2"></i>
                                        處理中...
                                    </>
                                ) : (
                                    isLogin ? '登入' : '註冊'
                                )}
                            </button>
                        </form>
                        
                        <div className="mt-6 text-center">
                            <button 
                                onClick={() => {
                                    setIsLogin(!isLogin);
                                    setError('');
                                }}
                                className="text-primary hover:underline"
                            >
                                {isLogin ? '還沒有帳號？立即註冊' : '已有帳號？立即登入'}
                            </button>
                        </div>
                        
                        {isLogin && (
                            <div className="mt-4 p-4 bg-blue-50 rounded-lg">
                                <p className="text-sm text-gray-600">
                                    <i className="fas fa-info-circle mr-2"></i>
                                    提示：輸入任意 Email 和密碼即可登入
                                </p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };
        
        // 會員中心頁
        const ProfilePage = () => {
            const { user, navigate, logout } = useApp();
            
            if (!user) {
                return (
                    <div className="container mx-auto px-4 py-20 text-center">
                        <p className="text-xl mb-4">請先登入</p>
                        <button 
                            onClick={() => navigate('login')}
                            className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                        >
                            前往登入
                        </button>
                    </div>
                );
            }
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">會員中心</h1>
                    
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div className="md:col-span-1">
                            <div className="bg-white rounded-lg shadow-md p-6">
                                <div className="text-center mb-6">
                                    <div className="w-24 h-24 bg-primary bg-opacity-10 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <i className="fas fa-user text-4xl text-primary"></i>
                                    </div>
                                    <h2 className="text-xl font-bold">{user.name}</h2>
                                    <p className="text-gray-600">{user.email}</p>
                                </div>
                                
                                <div className="space-y-2">
                                    <div className="flex items-center justify-between p-3 bg-gray-50 rounded">
                                        <span className="text-gray-600">會員點數</span>
                                        <span className="font-semibold text-primary">{user.points} 點</span>
                                    </div>
                                    <div className="flex items-center justify-between p-3 bg-gray-50 rounded">
                                        <span className="text-gray-600">加入日期</span>
                                        <span className="font-semibold">{user.joinDate}</span>
                                    </div>
                                </div>
                                
                                <button 
                                    onClick={logout}
                                    className="w-full mt-6 border-2 border-secondary text-secondary py-2 rounded-lg hover:bg-secondary hover:text-white transition"
                                >
                                    <i className="fas fa-sign-out-alt mr-2"></i>
                                    登出
                                </button>
                            </div>
                        </div>
                        
                        <div className="md:col-span-2">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div 
                                    onClick={() => navigate('orders')}
                                    className="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition"
                                >
                                    <div className="flex items-center mb-4">
                                        <div className="w-12 h-12 bg-primary bg-opacity-10 rounded-full flex items-center justify-center mr-4">
                                            <i className="fas fa-shopping-bag text-2xl text-primary"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold">我的訂單</h3>
                                    </div>
                                    <p className="text-gray-600">查看訂單狀態與歷史紀錄</p>
                                </div>
                                
                                <div 
                                    onClick={() => navigate('favorites')}
                                    className="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition"
                                >
                                    <div className="flex items-center mb-4">
                                        <div className="w-12 h-12 bg-secondary bg-opacity-10 rounded-full flex items-center justify-center mr-4">
                                            <i className="fas fa-heart text-2xl text-secondary"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold">我的收藏</h3>
                                    </div>
                                    <p className="text-gray-600">管理您喜愛的商品</p>
                                </div>
                                
                                <div 
                                    onClick={() => navigate('cart')}
                                    className="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition"
                                >
                                    <div className="flex items-center mb-4">
                                        <div className="w-12 h-12 bg-accent bg-opacity-10 rounded-full flex items-center justify-center mr-4">
                                            <i className="fas fa-shopping-cart text-2xl text-accent"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold">購物車</h3>
                                    </div>
                                    <p className="text-gray-600">查看購物車內的商品</p>
                                </div>
                                
                                <div className="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition">
                                    <div className="flex items-center mb-4">
                                        <div className="w-12 h-12 bg-warning bg-opacity-10 rounded-full flex items-center justify-center mr-4">
                                            <i className="fas fa-cog text-2xl text-warning"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold">帳號設定</h3>
                                    </div>
                                    <p className="text-gray-600">修改個人資料與密碼</p>
                                </div>
                            </div>
                            
                            <div className="bg-gradient-to-r from-primary to-purple-600 rounded-lg p-6 mt-6 text-white">
                                <h3 className="text-xl font-bold mb-2">會員專屬優惠</h3>
                                <p className="mb-4">累積點數享更多折扣！</p>
                                <button 
                                    onClick={() => navigate('promotions')}
                                    className="bg-white text-primary px-6 py-2 rounded-lg font-semibold hover:bg-opacity-90"
                                >
                                    查看優惠
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 訂單歷史頁
        const OrdersPage = () => {
            const { user, navigate } = useApp();
            const [orders, setOrders] = useState([]);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                if (!user) {
                    navigate('login');
                    return;
                }
                loadOrders();
            }, [user]);
            
            const loadOrders = async () => {
                setLoading(true);
                const ordersData = await DataService.getOrders();
                setOrders(ordersData);
                setLoading(false);
            };
            
            const statusColors = {
                pending: 'bg-yellow-100 text-yellow-800',
                processing: 'bg-blue-100 text-blue-800',
                shipped: 'bg-purple-100 text-purple-800',
                delivered: 'bg-green-100 text-green-800',
                cancelled: 'bg-red-100 text-red-800'
            };
            
            const statusTexts = {
                pending: '處理中',
                processing: '準備出貨',
                shipped: '已出貨',
                delivered: '已送達',
                cancelled: '已取消'
            };
            
            if (!user) return null;
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">訂單查詢</h1>
                    
                    {loading ? (
                        <Loading />
                    ) : orders.length === 0 ? (
                        <div className="text-center py-20">
                            <i className="fas fa-box-open text-6xl text-gray-300 mb-4"></i>
                            <p className="text-gray-500 mb-8">您還沒有任何訂單</p>
                            <button 
                                onClick={() => navigate('products')}
                                className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                            >
                                開始購物
                            </button>
                        </div>
                    ) : (
                        <div className="space-y-6">
                            {orders.map(order => (
                                <div key={order.id} className="bg-white rounded-lg shadow-md overflow-hidden">
                                    <div className="bg-gray-50 px-6 py-4 flex items-center justify-between">
                                        <div>
                                            <span className="text-gray-600">訂單編號：</span>
                                            <span className="font-semibold">{order.id}</span>
                                        </div>
                                        <div>
                                            <span className="text-gray-600 mr-4">
                                                {new Date(order.date).toLocaleDateString('zh-TW')}
                                            </span>
                                            <span className={`px-3 py-1 rounded-full text-sm ${statusColors[order.status]}`}>
                                                {statusTexts[order.status]}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div className="p-6">
                                        <div className="space-y-4 mb-4">
                                            {order.items.map(item => (
                                                <div key={item.id} className="flex items-center">
                                                    <img src={item.image} alt={item.name} className="w-16 h-16 object-cover rounded mr-4" />
                                                    <div className="flex-1">
                                                        <p className="font-semibold">{item.name}</p>
                                                        <p className="text-gray-600 text-sm">x {item.quantity}</p>
                                                    </div>
                                                    <span className="font-semibold">HK$ {item.price * item.quantity}</span>
                                                </div>
                                            ))}
                                        </div>
                                        
                                        <div className="border-t pt-4 flex items-center justify-between">
                                            <div className="text-xl font-bold">
                                                總計：<span className="text-primary">HK$ {order.total}</span>
                                            </div>
                                            <button 
                                                onClick={() => navigate('order-detail', { orderId: order.id })}
                                                className="text-primary hover:underline"
                                            >
                                            查看詳情 <i className="fas fa-arrow-right ml-2"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };
        
        // 訂單詳情頁
        const OrderDetailPage = () => {
            const { pageData, navigate } = useApp();
            const [order, setOrder] = useState(null);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                loadOrder();
            }, [pageData.orderId]);
            
            const loadOrder = async () => {
                setLoading(true);
                const orderData = await DataService.getOrder(pageData.orderId);
                setOrder(orderData);
                setLoading(false);
            };
            
            if (loading) return <Loading />;
            if (!order) return (
                <div className="container mx-auto px-4 py-20 text-center">
                    <p className="text-xl mb-4">找不到訂單</p>
                    <button 
                        onClick={() => navigate('orders')}
                        className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                    >
                        返回訂單列表
                    </button>
                </div>
            );
            
            const paymentMethods = {
                credit: '信用卡',
                atm: 'ATM 轉帳',
                cod: '貨到付款'
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <div className="mb-6">
                        <button 
                            onClick={() => navigate('orders')}
                            className="text-primary hover:underline"
                        >
                            <i className="fas fa-arrow-left mr-2"></i>
                            返回訂單列表
                        </button>
                    </div>
                    
                    <h1 className="text-3xl font-bold mb-8">訂單詳情</h1>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div className="lg:col-span-2">
                            <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                                <h2 className="text-xl font-bold mb-6">訂單商品</h2>
                                <div className="space-y-4">
                                    {order.items.map(item => (
                                        <div key={item.id} className="flex items-center border-b pb-4 last:border-b-0">
                                            <img src={item.image} alt={item.name} className="w-20 h-20 object-cover rounded mr-4" />
                                            <div className="flex-1">
                                                <p className="font-semibold">{item.name}</p>
                                                <p className="text-gray-600">x {item.quantity}</p>
                                            </div>
                                            <span className="font-semibold">HK$ {item.price * item.quantity}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            
                            <div className="bg-white rounded-lg shadow-md p-6">
                                <h2 className="text-xl font-bold mb-6">收件資訊</h2>
                                <div className="space-y-2">
                                    <p><span className="text-gray-600">姓名：</span>{order.customer.name}</p>
                                    <p><span className="text-gray-600">Email：</span>{order.customer.email}</p>
                                    <p><span className="text-gray-600">電話：</span>{order.customer.phone}</p>
                                    <p><span className="text-gray-600">地址：</span>{order.customer.address}</p>
                                    <p><span className="text-gray-600">付款方式：</span>{paymentMethods[order.customer.payment]}</p>
                                    {order.customer.note && (
                                        <p><span className="text-gray-600">備註：</span>{order.customer.note}</p>
                                    )}
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <div className="bg-white rounded-lg shadow-md p-6 sticky top-24">
                                <h2 className="text-xl font-bold mb-6">訂單資訊</h2>
                                
                                <div className="space-y-3 mb-6">
                                    <div>
                                        <span className="text-gray-600">訂單編號</span>
                                        <p className="font-semibold">{order.id}</p>
                                    </div>
                                    <div>
                                        <span className="text-gray-600">訂單日期</span>
                                        <p className="font-semibold">{new Date(order.date).toLocaleString('zh-TW')}</p>
                                    </div>
                                    <div>
                                        <span className="text-gray-600">訂單狀態</span>
                                        <p className="font-semibold text-primary">處理中</p>
                                    </div>
                                </div>
                                
                                <div className="border-t pt-4 space-y-2 mb-6">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">小計</span>
                                        <span>HK$ {order.subtotal}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">運費</span>
                                        <span>{order.shipping === 0 ? '免運' : `HK$ ${order.shipping}`}</span>
                                    </div>
                                    <div className="flex justify-between text-xl font-bold border-t pt-2">
                                        <span>總計</span>
                                        <span className="text-primary">HK$ {order.total}</span>
                                    </div>
                                </div>
                                
                                <button className="w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-opacity-90">
                                    聯絡客服
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 收藏頁
        const FavoritesPage = () => {
            const { favorites, navigate } = useApp();
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">我的收藏</h1>
                    
                    {favorites.length === 0 ? (
                        <div className="text-center py-20">
                            <i className="fas fa-heart text-6xl text-gray-300 mb-4"></i>
                            <p className="text-gray-500 mb-8">您還沒有收藏任何商品</p>
                            <button 
                                onClick={() => navigate('products')}
                                className="btn-primary bg-primary text-white px-8 py-3 rounded-lg"
                            >
                                開始探索
                            </button>
                        </div>
                    ) : (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            {favorites.map(product => (
                                <ProductCard key={product.id} product={product} />
                            ))}
                        </div>
                    )}
                </div>
            );
        };
        
        // 搜尋頁
        const SearchPage = () => {
            const [searchTerm, setSearchTerm] = useState('');
            const [results, setResults] = useState([]);
            const [loading, setLoading] = useState(false);
            const [hasSearched, setHasSearched] = useState(false);
            
            const handleSearch = async (e) => {
                e.preventDefault();
                if (!searchTerm.trim()) return;
                
                setLoading(true);
                setHasSearched(true);
                const products = await DataService.getProducts({ search: searchTerm });
                setResults(products);
                setLoading(false);
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">搜尋商品</h1>
                    
                    <form onSubmit={handleSearch} className="max-w-2xl mx-auto mb-12">
                        <div className="flex">
                            <input 
                                type="text"
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                                placeholder="搜尋零食、餅乾、巧克力..."
                                className="flex-1 px-6 py-3 border border-r-0 rounded-l-lg text-base"
                            />
                            <button 
                                type="submit"
                                className="bg-primary text-white px-8 py-3 rounded-r-lg hover:bg-opacity-90"
                            >
                                <i className="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                    
                    {loading ? (
                        <Loading />
                    ) : hasSearched ? (
                        results.length === 0 ? (
                            <div className="text-center py-20">
                                <i className="fas fa-search text-6xl text-gray-300 mb-4"></i>
                                <p className="text-gray-500">找不到相關商品</p>
                            </div>
                        ) : (
                            <>
                                <p className="text-gray-600 mb-6">找到 {results.length} 件商品</p>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    {results.map(product => (
                                        <ProductCard key={product.id} product={product} />
                                    ))}
                                </div>
                            </>
                        )
                    ) : (
                        <div className="text-center py-20 text-gray-500">
                            <i className="fas fa-search text-6xl text-gray-300 mb-4"></i>
                            <p>輸入關鍵字開始搜尋</p>
                        </div>
                    )}
                </div>
            );
        };
        
        // 優惠活動頁
        const PromotionsPage = () => {
            const [promotions, setPromotions] = useState([]);
            const [loading, setLoading] = useState(true);
            const { navigate } = useApp();
            
            useEffect(() => {
                loadPromotions();
            }, []);
            
            const loadPromotions = async () => {
                const data = await DataService.getPromotions();
                setPromotions(data);
                setLoading(false);
            };
            
            if (loading) return <Loading />;
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">優惠活動</h1>
                    
                    <div className="space-y-6">
                        {promotions.map(promo => (
                            <div key={promo.id} className="bg-white rounded-lg shadow-md overflow-hidden">
                                <div className="md:flex">
                                    <img 
                                        src={promo.image} 
                                        alt={promo.title}
                                        className="w-full md:w-1/3 h-64 object-cover"
                                    />
                                    <div className="p-6 flex-1">
                                        <h2 className="text-2xl font-bold mb-3">{promo.title}</h2>
                                        <p className="text-gray-600 mb-4">{promo.description}</p>
                                        
                                        <div className="flex flex-wrap gap-4 mb-4">
                                            {promo.discount && (
                                                <div className="flex items-center">
                                                    <i className="fas fa-tag text-primary mr-2"></i>
                                                    <span>
                                                        {promo.type === 'percentage' 
                                                            ? `全館 ${100 - promo.discount}折` 
                                                            : `折扣 HK$ ${promo.discount}`
                                                        }
                                                    </span>
                                                </div>
                                            )}
                                            {promo.minPurchase && (
                                                <div className="flex items-center">
                                                    <i className="fas fa-dollar-sign text-primary mr-2"></i>
                                                    <span>滿 HK$ {promo.minPurchase}</span>
                                                </div>
                                            )}
                                            {promo.freeShipping && (
                                                <div className="flex items-center">
                                                    <i className="fas fa-shipping-fast text-primary mr-2"></i>
                                                    <span>免運費</span>
                                                </div>
                                            )}
                                        </div>
                                        
                                        <div className="flex items-center justify-between">
                                            <span className="text-gray-600">
                                                <i className="fas fa-clock mr-2"></i>
                                                活動至 {promo.endDate}
                                            </span>
                                            <button 
                                                onClick={() => navigate('products')}
                                                className="bg-primary text-white px-6 py-2 rounded-lg hover:bg-opacity-90"
                                            >
                                                立即選購
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };
        
        // 關於我們頁
        const AboutPage = () => {
            return (
                <div className="animate-fade-in">
                    <div className="bg-gradient-to-r from-primary to-purple-600 text-white py-20">
                        <div className="container mx-auto px-4 text-center">
                            <h1 className="text-4xl font-bold mb-4">關於零食天堂</h1>
                            <p className="text-xl">為您帶來最優質的零食體驗</p>
                        </div>
                    </div>
                    
                    <div className="container mx-auto px-4 py-16">
                        <div className="max-w-4xl mx-auto">
                            <section className="mb-16">
                                <h2 className="text-3xl font-bold mb-6">我們的故事</h2>
                                <p className="text-gray-700 leading-relaxed mb-4">
                                    零食天堂成立於2025年，由一群熱愛美食的年輕人創立。我們相信，優質的零食不僅能滿足味蕾，更能為生活帶來小確幸。
                                </p>
                                <p className="text-gray-700 leading-relaxed">
                                    從最初的小小網店，到如今服務數萬名顧客，我們始終堅持「品質第一、顧客至上」的理念，為您精選來自世界各地的優質零食。
                                </p>
                            </section>
                            
                            <section className="mb-16">
                                <h2 className="text-3xl font-bold mb-6">我們的承諾</h2>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                    <div className="text-center">
                                        <div className="w-16 h-16 bg-primary bg-opacity-10 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <i className="fas fa-check-circle text-3xl text-primary"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold mb-2">嚴選品質</h3>
                                        <p className="text-gray-600">每一款商品都經過嚴格篩選</p>
                                    </div>
                                    
                                    <div className="text-center">
                                        <div className="w-16 h-16 bg-primary bg-opacity-10 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <i className="fas fa-truck text-3xl text-primary"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold mb-2">快速配送</h3>
                                        <p className="text-gray-600">24小時內快速出貨到府</p>
                                    </div>
                                    
                                    <div className="text-center">
                                        <div className="w-16 h-16 bg-primary bg-opacity-10 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <i className="fas fa-smile text-3xl text-primary"></i>
                                        </div>
                                        <h3 className="text-xl font-semibold mb-2">用心服務</h3>
                                        <p className="text-gray-600">專業客服團隊隨時待命</p>
                                    </div>
                                </div>
                            </section>
                            
                            <section>
                                <h2 className="text-3xl font-bold mb-6">聯絡我們</h2>
                                <div className="bg-gray-50 rounded-lg p-6">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <h3 className="font-semibold mb-2">客服專線</h3>
                                            <p className="text-gray-700">0800-123-456</p>
                                            <p className="text-sm text-gray-600">週一至週日 09:00-21:00</p>
                                        </div>
                                        
                                        <div>
                                            <h3 className="font-semibold mb-2">Email</h3>
                                            <p className="text-gray-700">service@snackheaven.com</p>
                                            <p className="text-sm text-gray-600">24小時內回覆</p>
                                        </div>
                                        
                                        <div>
                                            <h3 className="font-semibold mb-2">門市地址</h3>
                                            <p className="text-gray-700">九龍尖沙咀東科學館道16號華懋廣場UG3樓</p>
                                        </div>
                                        <div>
                                            <h3 className="font-semibold mb-2">營業時間</h3>
                                            <p className="text-gray-700">週一至週日 10:00-22:00</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* Google Map 區塊 */}
                            <div className="mt-8">
                            <h3 className="text-xl font-semibold mb-4">地圖位置</h3>
                            <div className="w-full h-64 rounded-lg overflow-hidden shadow">
                                <iframe
                                    title="Google Map"
                                    src="https://www.google.com/maps?q=九龍尖沙咀東科學館道16號華懋廣場UG3樓&output=embed"
                                    width="100%"
                                    height="100%"
                                    style={{ border: 0 }}
                                    allowFullScreen=""
                                    loading="lazy"
                                    referrerPolicy="no-referrer-when-downgrade"
                                ></iframe>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 聯絡我們頁
        const ContactPage = () => {
            const { showToast } = useApp();
            const [formData, setFormData] = useState({
                name: '',
                email: '',
                subject: '',
                message: ''
            });
            const [submitting, setSubmitting] = useState(false);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setSubmitting(true);
                
                // 模擬提交
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                showToast('訊息已送出，我們會盡快回覆您', 'success');
                setFormData({ name: '', email: '', subject: '', message: '' });
                setSubmitting(false);
            };
            
            return (
                <div className="container mx-auto px-4 py-8 animate-fade-in">
                    <h1 className="text-3xl font-bold mb-8">聯絡我們</h1>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
                        <div>
                            <h2 className="text-2xl font-bold mb-6">聯絡資訊</h2>
                            <div className="space-y-6">
                                <div className="flex items-start">
                                    <i className="fas fa-phone text-primary text-xl mr-4 mt-1"></i>
                                    <div>
                                        <h3 className="font-semibold mb-1">客服專線</h3>
                                        <p className="text-gray-700">0800-123-456</p>
                                        <p className="text-sm text-gray-600">週一至週日 09:00-21:00</p>
                                    </div>
                                </div>
                                
                                <div className="flex items-start">
                                    <i className="fas fa-envelope text-primary text-xl mr-4 mt-1"></i>
                                    <div>
                                        <h3 className="font-semibold mb-1">Email</h3>
                                        <p className="text-gray-700">service@snackheaven.com</p>
                                        <p className="text-sm text-gray-600">24小時內回覆</p>
                                    </div>
                                </div>
                                
                                <div className="flex items-start">
                                    <i className="fas fa-map-marker-alt text-primary text-xl mr-4 mt-1"></i>
                                    <div>
                                        <h3 className="font-semibold mb-1">門市地址</h3>
                                        <p className="text-gray-700">九龍尖沙咀東科學館道16號華懋廣場UG3樓</p>
                                    </div>
                                </div>
                                
                                <div className="flex items-start">
                                    <i className="fas fa-clock text-primary text-xl mr-4 mt-1"></i>
                                    <div>
                                        <h3 className="font-semibold mb-1">營業時間</h3>
                                        <p className="text-gray-700">週一至週日 10:00-22:00</p>
                                    </div>
                                </div>
                            </div>
                        
                        {/* Google Map 區塊 */}
                    <div className="mt-8">
                        <h3 className="text-xl font-semibold mb-4">地圖位置</h3>
                        <div className="w-full h-64 rounded-lg overflow-hidden shadow">
                            <iframe
                                title="Google Map"
                                src="https://www.google.com/maps?q=九龍尖沙咀東科學館道16號華懋廣場UG3樓&output=embed"
                                width="100%"
                                height="100%"
                                style={{ border: 0 }}
                                allowFullScreen=""
                                loading="lazy"
                                referrerPolicy="no-referrer-when-downgrade"
                            ></iframe>
                        </div>
                    </div>
                        </div>
                        
                        <div>
                            <h2 className="text-2xl font-bold mb-6">傳送訊息</h2>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className="block text-gray-700 mb-2">姓名</label>
                                    <input 
                                        type="text"
                                        value={formData.name}
                                        onChange={(e) => setFormData({...formData, name: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-gray-700 mb-2">Email</label>
                                    <input 
                                        type="email"
                                        value={formData.email}
                                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-gray-700 mb-2">主題</label>
                                    <input 
                                        type="text"
                                        value={formData.subject}
                                        onChange={(e) => setFormData({...formData, subject: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-gray-700 mb-2">訊息</label>
                                    <textarea 
                                        value={formData.message}
                                        onChange={(e) => setFormData({...formData, message: e.target.value})}
                                        className="w-full px-4 py-2 border rounded-lg text-base"
                                        rows="5"
                                        required
                                    ></textarea>
                                </div>
                                
                                <button 
                                    type="submit"
                                    disabled={submitting}
                                    className="btn-primary bg-primary text-white px-8 py-3 rounded-lg font-semibold disabled:opacity-50"
                                >
                                    {submitting ? (
                                        <>
                                            <i className="fas fa-spinner fa-spin mr-2"></i>
                                            傳送中...
                                        </>
                                    ) : (
                                        '傳送訊息'
                                    )}
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        };
        
        // 主應用組件
        const App = () => {
            const { currentPage, toast, navigate } = useApp();
            
            const renderPage = () => {
                switch (currentPage) {
                    case 'home':
                        return <HomePage />;
                    case 'products':
                        return <ProductsPage />;
                    case 'product-detail':
                        return <ProductDetailPage />;
                    case 'category':
                        return <CategoryPage />;
                    case 'cart':
                        return <CartPage />;
                    case 'checkout':
                        return <CheckoutPage />;
                    case 'order-confirm':
                        return <OrderConfirmPage />;
                    case 'login':
                        return <LoginPage />;
                    case 'profile':
                        return <ProfilePage />;
                    case 'orders':
                        return <OrdersPage />;
                    case 'order-detail':
                        return <OrderDetailPage />;
                    case 'favorites':
                        return <FavoritesPage />;
                    case 'search':
                        return <SearchPage />;
                    case 'promotions':
                        return <PromotionsPage />;
                    case 'about':
                        return <AboutPage />;
                    case 'contact':
                        return <ContactPage />;
                    default:
                        return <HomePage />;
                }
            };
            
            return (
                <div className="min-h-screen bg-gray-50">
                    <Header />
                    <main>
                        {renderPage()}
                    </main>
                    <Footer />
                    {toast && <Toast message={toast.message} type={toast.type} />}
                </div>
            );
        };
        
        // 渲染應用
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <AppProvider>
                <App />
            </AppProvider>
        );
    </script>
</body>
</html>